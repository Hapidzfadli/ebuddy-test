(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1185:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(5155);t(2115);var i=t(9670);let a=e=>{let{children:r,...t}=e;return(0,s.jsx)(i.A,{...t,children:r})}},1425:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>G});var s=t(5155),i=t(2115),a=t(5695),l=t(4540),n=t(2269),d=t(2693),o=t(3746),c=t(1600),u=t(5439),h=t(4995),x=t(6444),A=t(3032),j=t(3687),m=t(3737),p=t(4146),y=t(2131),v=t(8167),g=t(4971),b=t(2204),f=t(4732),U=t(4824),k=t(1185);let w=()=>{let[e,r]=i.useState(!1),t=(0,o.A)(),d=(0,c.A)(t.breakpoints.down("md")),w=(0,a.useRouter)(),C=(0,l.wA)(),{isAuthenticated:S,user:N}=(0,l.d4)(e=>e.auth),E=async()=>{try{await U.j.signOut(),C((0,f.ri)()),w.push("/login")}catch(e){console.error("Error signing out:",e)}},W=()=>{r(!e)},R=(0,s.jsxs)(n.A,{sx:{width:250},role:"presentation",children:[(0,s.jsx)(u.A,{children:(0,s.jsx)(h.Ay,{children:(0,s.jsx)(x.A,{primary:(null==N?void 0:N.displayName)||(null==N?void 0:N.email)||"User",secondary:"Profile"})})}),(0,s.jsx)(A.A,{}),(0,s.jsx)(u.A,{children:(0,s.jsx)(h.Ay,{button:!0,onClick:E,children:(0,s.jsx)(x.A,{primary:"Logout"})})})]});return(0,s.jsxs)(j.A,{position:"static",children:[(0,s.jsxs)(m.A,{children:[d&&S&&(0,s.jsx)(p.A,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},onClick:W,children:(0,s.jsx)(v.A,{})}),(0,s.jsx)(k.A,{variant:"h6",component:"div",sx:{flexGrow:1},children:"EBUDDY App"}),S?(0,s.jsx)(s.Fragment,{children:!d&&(0,s.jsxs)(n.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(p.A,{color:"inherit",children:(0,s.jsx)(g.A,{})}),(0,s.jsx)(k.A,{variant:"body1",sx:{mr:2},children:(null==N?void 0:N.displayName)||(null==N?void 0:N.email)||"User"}),(0,s.jsx)(p.A,{color:"inherit",onClick:E,children:(0,s.jsx)(b.A,{})})]})}):(0,s.jsx)(Button,{color:"inherit",onClick:()=>w.push("/login"),children:"Login"})]}),(0,s.jsx)(y.Ay,{anchor:"left",open:e,onClose:W,children:R})]})},C=e=>{let{children:r}=e;return(0,s.jsxs)(n.A,{sx:{minHeight:"100vh",backgroundColor:"#f5f5f5"},children:[(0,s.jsx)(w,{}),(0,s.jsx)(d.A,{maxWidth:"lg",sx:{py:4},children:r})]})};var S=t(9915),N=t(1063),E=t(4265),W=t(3951),R=t(3923);let D=t(3464).A.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}});D.interceptors.request.use(async e=>{let r=U.j.currentUser;if(r){let t=await r.getIdToken();e.headers.Authorization="Bearer ".concat(t)}return e},e=>Promise.reject(e));let I=async e=>{try{return(await D.get(e?"/fetch-user-data/".concat(e):"/fetch-user-data")).data.user}catch(e){throw console.error("Error fetching user data:",e),e}},L=async(e,r)=>{try{return(await D.put("/update-user-data/".concat(e),r)).data.user}catch(e){throw console.error("Error updating user data:",e),e}};var B=t(5857);let F=e=>{let{children:r,loading:t=!1,disabled:i,...a}=e;return(0,s.jsx)(B.A,{disabled:t||i,...a,children:t?"Loading...":r})};var O=t(8034);let _=e=>(0,s.jsx)(O.A,{fullWidth:!0,variant:"outlined",...e}),z=()=>{let e=(0,l.wA)(),{user:r}=(0,l.d4)(e=>e.auth),{userData:t,loading:a,success:d,error:o}=(0,l.d4)(e=>e.user),[c,u]=(0,i.useState)(!1),[h,x]=(0,i.useState)(""),[A,j]=(0,i.useState)("");(0,i.useEffect)(()=>{(null==r?void 0:r.uid)&&m()},[null==r?void 0:r.uid]),(0,i.useEffect)(()=>{t&&(x(t.name||""),j(t.email||""))},[t]),(0,i.useEffect)(()=>{if(d||o){let r=setTimeout(()=>{e((0,R.Un)())},3e3);return()=>clearTimeout(r)}},[d,o,e]);let m=async()=>{if(null==r?void 0:r.uid)try{e((0,R.eG)());let t=await I(r.uid);e((0,R.zi)(t))}catch(r){e((0,R.QQ)(r.message||"Failed to fetch user data"))}},p=async()=>{if(null==r?void 0:r.uid)try{e((0,R.x)());let t=await L(r.uid,{name:h,email:A});e((0,R.e$)(t)),u(!1)}catch(r){e((0,R.$0)(r.message||"Failed to update user data"))}},y=e=>e?new Date(e).toLocaleString():"N/A";return a?(0,s.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",my:4},children:(0,s.jsx)(S.A,{})}):(0,s.jsxs)(N.A,{elevation:3,sx:{p:3,my:3},children:[d&&(0,s.jsx)(E.A,{severity:"success",sx:{mb:2},children:"Operation successful!"}),o&&(0,s.jsx)(E.A,{severity:"error",sx:{mb:2},children:o}),(0,s.jsxs)(n.A,{sx:{mb:3},children:[(0,s.jsx)(k.A,{variant:"h5",component:"h2",gutterBottom:!0,children:"User Profile"}),(0,s.jsx)(F,{variant:"contained",color:"primary",onClick:c?p:()=>u(!0),sx:{mr:1},children:c?"Save Changes":"Edit Profile"}),c&&(0,s.jsx)(F,{variant:"outlined",onClick:()=>u(!1),children:"Cancel"})]}),(0,s.jsxs)(W.Ay,{container:!0,spacing:2,children:[(0,s.jsx)(W.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(n.A,{sx:{mb:2},children:[(0,s.jsx)(k.A,{variant:"subtitle1",fontWeight:"bold",children:"Name"}),c?(0,s.jsx)(_,{value:h,onChange:e=>x(e.target.value),placeholder:"Name"}):(0,s.jsx)(k.A,{variant:"body1",children:(null==t?void 0:t.name)||"N/A"})]})}),(0,s.jsx)(W.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(n.A,{sx:{mb:2},children:[(0,s.jsx)(k.A,{variant:"subtitle1",fontWeight:"bold",children:"Email"}),c?(0,s.jsx)(_,{value:A,onChange:e=>j(e.target.value),placeholder:"Email",type:"email"}):(0,s.jsx)(k.A,{variant:"body1",children:(null==t?void 0:t.email)||"N/A"})]})}),(null==t?void 0:t.totalAverageWeightRatings)!==void 0&&(0,s.jsx)(W.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(n.A,{sx:{mb:2},children:[(0,s.jsx)(k.A,{variant:"subtitle1",fontWeight:"bold",children:"Average Weight Ratings"}),(0,s.jsx)(k.A,{variant:"body1",children:t.totalAverageWeightRatings.toFixed(1)})]})}),(null==t?void 0:t.numberOfRents)!==void 0&&(0,s.jsx)(W.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(n.A,{sx:{mb:2},children:[(0,s.jsx)(k.A,{variant:"subtitle1",fontWeight:"bold",children:"Number of Rents"}),(0,s.jsx)(k.A,{variant:"body1",children:t.numberOfRents})]})}),(null==t?void 0:t.recentlyActive)&&(0,s.jsx)(W.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(n.A,{sx:{mb:2},children:[(0,s.jsx)(k.A,{variant:"subtitle1",fontWeight:"bold",children:"Last Active"}),(0,s.jsx)(k.A,{variant:"body1",children:y(t.recentlyActive)})]})}),(0,s.jsx)(W.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(n.A,{sx:{mb:2},children:[(0,s.jsx)(k.A,{variant:"subtitle1",fontWeight:"bold",children:"Created At"}),(0,s.jsx)(k.A,{variant:"body1",children:y(null==t?void 0:t.createdAt)})]})}),(0,s.jsx)(W.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(n.A,{sx:{mb:2},children:[(0,s.jsx)(k.A,{variant:"subtitle1",fontWeight:"bold",children:"Updated At"}),(0,s.jsx)(k.A,{variant:"body1",children:y(null==t?void 0:t.updatedAt)})]})})]})]})};function G(){let{isAuthenticated:e,user:r}=(0,l.d4)(e=>e.auth),t=(0,a.useRouter)();return((0,i.useEffect)(()=>{e||t.push("/login")},[e,t]),e)?(0,s.jsxs)(C,{children:[(0,s.jsxs)(n.A,{sx:{mb:4},children:[(0,s.jsx)(k.A,{variant:"h4",component:"h1",gutterBottom:!0,children:"Dashboard"}),(0,s.jsxs)(k.A,{variant:"body1",color:"text.secondary",children:["Welcome back, ",(null==r?void 0:r.displayName)||(null==r?void 0:r.email)||"User","! Here's your profile information."]})]}),(0,s.jsx)(z,{})]}):null}},3923:(e,r,t)=>{"use strict";t.d(r,{$0:()=>o,Ay:()=>u,QQ:()=>l,Un:()=>c,e$:()=>d,eG:()=>i,x:()=>n,zi:()=>a});let s=(0,t(1990).Z0)({name:"user",initialState:{userData:null,loading:!1,success:!1,error:null},reducers:{fetchUserStart:e=>{e.loading=!0,e.success=!1,e.error=null},fetchUserSuccess:(e,r)=>{e.userData=r.payload,e.loading=!1,e.success=!0,e.error=null},fetchUserFailure:(e,r)=>{e.loading=!1,e.success=!1,e.error=r.payload},updateUserStart:e=>{e.loading=!0,e.success=!1,e.error=null},updateUserSuccess:(e,r)=>{e.userData=r.payload,e.loading=!1,e.success=!0,e.error=null},updateUserFailure:(e,r)=>{e.loading=!1,e.success=!1,e.error=r.payload},resetUserState:e=>{e.success=!1,e.error=null}}}),{fetchUserStart:i,fetchUserSuccess:a,fetchUserFailure:l,updateUserStart:n,updateUserSuccess:d,updateUserFailure:o,resetUserState:c}=s.actions,u=s.reducer},4732:(e,r,t)=>{"use strict";t.d(r,{AU:()=>i,Ay:()=>d,Ne:()=>a,ie:()=>l,ri:()=>n});let s=(0,t(1990).Z0)({name:"auth",initialState:{isAuthenticated:!1,user:null,loading:!1,error:null},reducers:{loginStart:e=>{e.loading=!0,e.error=null},loginSuccess:(e,r)=>{e.isAuthenticated=!0,e.user={uid:r.payload.uid,email:r.payload.email,displayName:r.payload.displayName},e.loading=!1,e.error=null},loginFailure:(e,r)=>{e.isAuthenticated=!1,e.user=null,e.loading=!1,e.error=r.payload},logout:e=>{e.isAuthenticated=!1,e.user=null,e.loading=!1,e.error=null}}}),{loginStart:i,loginSuccess:a,loginFailure:l,logout:n}=s.actions,d=s.reducer},4824:(e,r,t)=>{"use strict";t.d(r,{j:()=>n});var s=t(3915),i=t(6203),a=t(5317);let l=(0,s.Wp)({apiKey:"AIzaSyAp8NHkbZQ7lxkVGm8fH0L1cyHWO2869vM",authDomain:"ebuddy-project-e87d0.firebaseapp.com",projectId:"ebuddy-project-e87d0",storageBucket:"ebuddy-project-e87d0.appspot.com",messagingSenderId:"547207874019",appId:"1:547207874019:web:ad5d13ed6c50ac69178cd6",measurementId:"G-E9JB0295LJ"}),n=(0,i.xI)(l);(0,a.aU)(l)},9542:(e,r,t)=>{Promise.resolve().then(t.bind(t,1425))}},e=>{var r=r=>e(e.s=r);e.O(0,[992,888,540,158,657,64,441,684,358],()=>r(9542)),_N_E=e.O()}]);